<!-- saved from url=(0013)about:internet -->

<!-- Domino - copyright John Rainford 2004 -->

<html>

<head>
   <script language="JavaScript" src="printf.js"></script>
   <script language="JavaScript" src="debug.js"></script>
   <script type="text/javascript">


      var firstLoad = true;
      var gameOver = false;
      var boardWidth = 80;
      var boardHeight = 38;

      var board = new Array();

      var up = 1;
      var right = 2;
      var down = 3;
      var left = 4;

      var player1X = 10;
      var player1Y = 8;
      var player1direction = right;
      var player2X = boardWidth - 10;
      var player2Y = 10;
      var player2direction = left;


      function main() {
         debug();

         if (player1direction == up) player1Y -= 1;
         if (player1direction == down) player1Y += 1;
         if (player1direction == left) player1X -= 1;
         if (player1direction == right) player1X += 1;

         if (board[player1Y * boardWidth + player1X] == 0) {
            ChangeCellColor(player1Y, player1X, 'black');
         } else {
            alert("Game over!");
            gameOver = true;
         }

         if (gameOver == false) {
            setTimeout('main()', 200);
         }
      }



      function clearMap() {
         for (i = 0; i <= boardHeight * boardWidth - 1; i++) {
            board[i] = 0;
         }
      }



      function clearBoard() {
         for (y = 0; y <= boardHeight - 1; y++) {
            for (x = 0; x <= boardWidth - 1; x++) {
               eval(sprintf("b%02d%02d", y, x)).bgColor = 'blue';
            }
         }
      }



      function onLD() {
         clearMap();
         if (firstLoad) firstLoad = false; else clearBoard();

         player1X = 7;
         player1Y = 8;
         player1direction = right;

         drawBorder();
         main();
      }




      function drawBorder() {

         for (i = 0; i <= boardWidth - 1; i++) {
            ChangeCellColor(0, i, 'green');
            ChangeCellColor(boardHeight - 1, i, 'green');
         }

         for (i = 0; i <= boardHeight - 1; i++) {
            ChangeCellColor(i, 0, 'green');
            ChangeCellColor(i, boardWidth - 1, 'green');
         }

      }



      function debug() {
         debug1.innerHTML = sprintf("player1 X = %3d, Y= %3d", player1X, player1Y);
         debug2.innerHTML = sprintf("player1direction = %d", player1direction);

         // debug5.innerHTML = "";
         // for (r = 0; r <= boardHeight - 1; r++) {
         //    for (c = 0; c <= boardWidth - 1; c++) {
         //       debug5.innerHTML += sprintf ("%d ", board[r*boardHeight + c]);
         //       if (board[r * boardWidth + c] == 1) {
         //          debug5.innerHTML += "X";
         //       } else debug5.innerHTML += ".";
         //    }
         //    debug5.innerHTML += sprintf("<br>");
         // }
      }




      function ChangeCellColor(y, x, color) {
         board[y * boardWidth + x] = 1;
         eval(sprintf("b%02d%02d", y, x)).bgColor = color;

         // debug5.innerHTML += sprintf ("b%02d%02d ", y, x);
      }



      function getKey(key) {
         if (key != 0) {
            key2 = String.fromCharCode(key);
            debug4.innerHTML = sprintf("Key pressed = [%s]", key2);

            if (key2 == "q") { player1direction -= 1; } else if (key2 == "w") { player1direction += 1; }

            if (player1direction > 4) player1direction = 1;
            if (player1direction < 1) player1direction = 4;
         }
      }



      debugPanel(5);

   </script>
</head>



<body onload="onLD()" ; onkeypress="getKey(event.keyCode)" ;>




   <table border="0" cellpadding=0 cellspacing=0>

      <script language="javascript">
         for (r = 0; r <= boardHeight - 1; r++) {
            document.write('<tr>');
            for (c = 0; c <= boardWidth - 1; c++) {
               document.write(sprintf("<td id='b%02d%02d' bgColor='yellow' width='15' height='15'></td>", r, c));
               // document.write(sprintf (" id%02d%02d</td>", r, c));
            }
            document.write('</tr>');
         }
      </script>

   </table>




</body>

</html>